function [Y,Xf,Af] = Predict_yield_cad(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 11-Jul-2017 16:43:00.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 102xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102];
x1_step2.xoffset = [348;348;348;344;343;343;343;341;347;344;340;336;335;338;333;330;328;329;330;330;325;328;330;326;342;339;333;328;326;327;334;333;326;325;322;316;313;309;305;303;298;299;295;290;289;284;278;272;276;269;263;262;257;253;263;257;263;258;253;247;244;243;240;248;249;247;267;264;259;267;267;260;256;263;271;265;263;263;261;260;259;258;258;262;259;263;264];
x1_step2.gain = [0.0714285714285714;0.08;0.1;0.125;0.153846153846154;0.0666666666666667;0.0540540540540541;0.0833333333333333;0.0666666666666667;0.0606060606060606;0.05;0.0487804878048781;0.0512820512820513;0.0769230769230769;0.0555555555555556;0.05;0.0526315789473684;0.0487804878048781;0.0526315789473684;0.0256410256410256;0.0338983050847458;0.037037037037037;0.0392156862745098;0.0392156862745098;0.0317460317460317;0.03125;0.0256410256410256;0.0263157894736842;0.037037037037037;0.0434782608695652;0.0338983050847458;0.0303030303030303;0.0425531914893617;0.04;0.037037037037037;0.032258064516129;0.0294117647058824;0.0363636363636364;0.0384615384615385;0.0289855072463768;0.0277777777777778;0.0294117647058824;0.0289855072463768;0.0294117647058824;0.0253164556962025;0.0206185567010309;0.0232558139534884;0.0240963855421687;0.0222222222222222;0.021978021978022;0.0188679245283019;0.0188679245283019;0.0168067226890756;0.0175438596491228;0.018018018018018;0.0163934426229508;0.0198019801980198;0.0166666666666667;0.0178571428571429;0.018348623853211;0.015748031496063;0.0163934426229508;0.0170940170940171;0.0196078431372549;0.0198019801980198;0.0155038759689922;0.015625;0.015625;0.015625;0.0170940170940171;0.0152671755725191;0.018018018018018;0.0166666666666667;0.0166666666666667;0.0172413793103448;0.019047619047619;0.0206185567010309;0.0188679245283019;0.018348623853211;0.0198019801980198;0.0185185185185185;0.0185185185185185;0.0188679245283019;0.019047619047619;0.0170940170940171;0.0170940170940171;0.0170940170940171];
x1_step2.ymin = -1;

% Layer 1
b1 = [-1.4902095460006393;-1.1108411368527686;-0.53581420983198447;-0.35520852627799931;-0.43006095172744635;-0.019890420506930746;-0.71923837205989738;-0.66953459673077476;-1.1061363562799817;-1.5598162100310251];
IW1_1 = [0.41409111720174696 0.069056846567965235 0.2228214686818607 0.23893674137014981 0.29013443961260021 -0.053353814138273586 -0.07366627743079282 0.21412825083981116 0.24554617408440738 0.0044703987164504584 -0.076321333413825007 0.070364665845641591 0.12949182387146371 -0.16907374301287326 0.18902419473590287 -0.18787096440621043 -0.092830786328491011 0.1806583694031452 -0.10714811835837432 -0.074597946474128207 -0.10845260285524702 -0.074180426262427976 -0.31619053469798014 0.15250147851903476 0.23893830853686721 0.032652352472101034 -0.14557290535637352 -0.10049554690665899 -0.25496923257765741 0.035644595838714432 -0.24425272285450517 0.063300895101492033 0.12552661844203986 -0.019731117546386748 0.28240979365642305 -0.27825572752225364 -0.13671883594405354 -0.17142359777518154 -0.047964159535943934 0.29064238558861194 -0.11220458513206034 -0.23289194675655556 -0.21478192471800681 -0.15011398204671764 0.083538847832226384 -0.19550828544956794 -0.1202316526032076 -0.042406745107257546 0.12473697577326123 0.2246228010432019 -0.19614543426851974 -0.1572437627869363 0.0027897864376920114 -0.29787120340070117 -0.023817389663264337 -0.19815391543240082 0.21655961719430628 -0.21286112647399602 0.22199395449874382 -0.25485158185987228 -0.31180679407267092 -0.15135585568470519 0.14065390763062496 -0.15563783736556119 0.021020049559166771 -0.10006129939241169 0.009402406662527351 0.12913539987274014 0.13315133833301451 -0.061732337280198619 0.19434350952046234 0.11397361555946364 0.098155007537726213 0.14004016875822256 0.10600219389758712 0.22749887347424882 0.21476701538455928 -0.0098941677662007614 0.17781536816803303 0.12670702672247469 0.057005130680601208 0.2270144446759543 0.23022036905184368 0.18555507535814636 -0.080666362354185533 -0.083383705823680224 0.19846781667722063;0.11810190267901163 -0.11624840946173649 -0.1472860151355343 -0.27794880193894406 -0.032042967822704188 -0.2433383645546684 -0.30973075902824659 0.01127691007976097 0.045268638067301692 0.26707726128468617 0.048411908135399785 0.15591099426733027 0.0030567729263647021 0.17351578469584822 0.039058825092521246 -0.24579153308731269 0.18259263467337961 -0.24217542284300411 -0.016856483038488843 0.23840805342237897 0.046388327495037185 0.22701383033462733 0.13010370913007072 -0.20414444105794785 -0.23990750697721247 -0.38510734804294533 0.13166623957463761 0.20576715433853107 0.17513076027885724 -0.26925922034615307 0.047698765007818777 -0.33634403568876381 0.06286568705580968 -0.012126287798221043 -0.25929666371842652 -0.012093938246104805 0.087642204773113255 -0.16976132318309883 0.1816717403206822 0.15032760950307722 -0.032971894277849814 0.020807020842602036 -0.074503630208630614 0.18570554161372091 -0.21460084841407839 -0.2662253481179499 0.024801636334764621 0.0073866535558108548 0.094418253245104916 -0.18976810263764304 -0.25268704863271241 -0.14861132330038085 0.093581120092175146 -0.22227622452603152 0.10853694089175607 -0.16855913632113093 0.19757988856209266 -0.25212300866382881 0.1085392561797564 0.015466433437124043 -0.062050041745582159 0.086914152792955529 -0.075232176588186914 -0.19956776713787025 -0.0078464729063334737 -0.24347085074380911 -0.00085997227395206272 0.0095202359329523353 0.055381570735504419 0.030216832416542716 0.20064488435059066 0.24705651466041845 0.16208576120232807 -0.075008654934012153 -0.20839323961498138 -0.028751999993725533 0.21077359181461405 -0.049855757196272756 0.093858329252070494 -0.045063152962754344 -0.1110856186092983 0.027582787471933195 0.068742821363065698 -0.148241245464619 -0.18123326187732541 0.3086214112685256 0.16563972673282099;0.051498399881832843 0.14737438563835781 0.021433227258748778 0.22832502909124885 -0.38239774937764781 0.051036755397970965 0.11191159917069232 -0.098746369944192947 -0.29838494470374732 -0.15008187311901061 -0.063673517516351877 0.37830984044000826 0.056586396760772206 -0.049606048297412303 0.19199391964600521 -0.094162377395524327 0.0026243190052012595 0.22923020455914822 0.023249370360747104 -0.086931703367406382 0.23832012381268503 -0.33269591476810068 -0.077582670639071635 0.24285849934783588 -0.21622749628302296 0.030672700402292183 0.12665610460583904 -0.09259917353134034 0.011542185119783596 0.082765824299323276 0.18612120946218674 -0.062610969195691757 -0.15026010538555593 0.36041686120150684 -0.27555023400817391 0.31780284693176108 0.14316876842604165 0.0048717731926018019 -0.26263709302327681 0.06444190172346792 -0.056265491387339869 0.22193652984711104 -0.14471099293078404 0.20199599185951322 -0.082371589519716404 0.032877164201259058 0.14179925444834285 0.19178429034995292 0.1996717934519138 0.1363917802658812 -0.08818077666963936 0.10687874517132295 0.33983318225895121 -0.047818359355963402 0.12787892610476664 0.024504998778608025 -0.27202019552162304 -0.071996288014047838 -0.15655059313137284 -0.22626289318624238 -0.16804232801718638 -0.23342797698250356 0.0038588744681142401 -0.23589295076641842 0.04073785466403676 0.059638774983960266 -0.098024298856174016 -0.024393586374463483 0.065556312589390264 0.32498966373083626 0.14862577185999798 -0.19683836617254769 0.094399176276675961 0.030723293849677143 -0.17160135977810947 -0.20837832505927659 -0.11621528347415432 0.056612182238377037 -0.3160340716683982 -0.29332151295642495 -0.16054272915675014 0.0053268562711346612 0.089060488073976346 0.092748517096214927 0.10467540429214597 0.012644664967248901 -0.24903802876524686;-0.026825584550112656 -0.084399349416491576 -0.33244018793030655 0.025740640857958682 -0.00033129866455146664 -0.061052893454582889 -0.11489451271859535 -0.01029651938887826 -0.41670784313620368 -0.038406503071024944 -0.38183785865614728 -0.14865330527907508 0.069759948194259444 -0.32894785060846871 -0.27715476030557606 -0.26789005859877674 -0.36287387069457927 -0.13634070295476239 -0.0067874382793701171 -0.22135569678078779 0.011181219692358538 -0.047813479210585187 -0.1514724329373591 -0.069615280169379332 -0.4155333731680016 -0.27305923717213587 -0.081167933484900798 -0.23974853031728888 -0.16144920367359988 0.0087106613221013991 0.13973365350478659 -0.034915229324821655 -0.26852521664381129 0.011275028293303995 0.0095394632621646751 -0.17097942561921387 0.081425012078482281 0.30924755503975754 0.11815818353575412 -0.25291158058702568 0.23502811929401782 -0.16827112954230827 -0.065511734152691445 -0.049534542199597756 0.1451111998220192 0.17450516576039055 -0.038249879796949451 0.24524775553922176 -0.036249494280449976 -0.00092702371122540834 -0.13954156543990121 0.21743356657458252 -0.12791624322393827 0.20953153403123739 0.096832790006669126 -0.13854870785035053 0.30863946656160834 -0.18707133559427097 -0.047271820928472576 -0.18066053199636989 0.21996166155289307 0.02718983006154518 -0.0043727563280389799 0.094509571577431811 -0.08988854486582451 0.15528529685290732 -0.23286498039804218 -0.030032139667922134 -0.1743320776070422 -0.14561587927807942 0.070226255979493224 0.19297414098145629 -0.001316099686240811 -0.24877061309170576 0.07030436029315644 0.14425600582868039 -0.19695375089531406 -0.18222529560296871 0.0098135900235018694 0.1767525370855477 0.09931461055575859 -0.33423823025833077 0.015561738166952905 0.15806272565004387 -0.059878780165886464 -0.1318850051235087 -0.24919872485089031;0.22861818597159961 0.018608647764974541 0.33057967423371615 0.15109645151665221 -0.11623893651929924 -0.17125899969766584 0.037048568017661411 0.16931254706197937 0.29961796015186587 -0.05903673756827954 -0.22989276361819441 0.053818373731410213 0.05946094580033038 0.26747520323430668 -0.15896194801620708 0.070618513279977896 0.22686338033246606 -0.030025574093618036 -0.15398937192650947 0.43917729631357727 -0.00079236721638553664 -0.032986034839451776 -0.070113497288080084 0.25957512078691158 0.32997212895584932 0.03235117501885508 0.37186498025555631 0.20747391504838653 -0.0018364521785569146 0.30194782778736062 0.36143436964744391 0.29647955473134441 -0.19921037829223046 0.27931375210165954 0.078486799111898056 0.048426065829089621 0.23156797118269581 0.10203142421126869 0.032058007378481385 -0.05309051750548642 0.22822722289216427 -0.20435993734296204 -0.37706814989069454 -0.050318905511965453 0.15502109908812228 0.078198795351773515 -0.0062876488014539586 0.30559346561677708 0.10029167682709259 -0.14882655751150373 -0.12497683628184623 0.021257003020528652 0.20891953655941206 0.097160408481173605 0.12070907728613134 -0.10715419122462216 -0.2061676399751354 -0.26654713660872092 -0.12284649106919181 0.065059907623615354 0.013170678168806078 0.089902967328293337 0.2575193550460303 0.15130213723094577 0.1832249537334851 0.20743242129389722 0.023249846194767415 0.27524677367246952 0.14502403519034668 -0.01997125181515505 0.11707124187007945 -0.12327431715200651 -0.16487008929652655 -0.25905719145285927 0.20478537832629129 -0.2688721068255554 -0.31839614688263679 0.20785663123446535 -0.2871732563183278 0.095359057728738483 -0.0025279048467813136 0.032557526986235985 0.064685298500675226 -0.18519991469949501 0.1189636478684217 -0.031123562406271919 -0.16475108894299553;-0.31121113517673155 0.07911924476919388 -0.0099496730871423879 0.22140358538028296 0.21279785489755842 0.30790501289238903 0.37684038321660096 0.26745720154578156 0.051560198212657074 0.072387388565183716 -0.2636811870469567 0.09586808124991078 0.17031543781409073 -0.18135148074836976 -0.0028460609559115887 0.29616994603754204 0.16268074566863588 0.099505909258825798 0.3139942328905308 -0.25485866633456633 -0.064649914305224335 -0.21404378256384507 0.16056639718697813 -0.10637472333736611 -0.10794046176697596 -0.052639191117403478 0.017392050321220785 -0.014655693395941138 -0.1047344365173111 -0.052077475342414817 -0.12082949148357362 -0.12226450821297137 -0.053532673909723119 0.067002118418398038 0.056834221508262006 -0.20496216729954192 -0.012337560175090859 0.13046262922407029 -0.069072861038354777 -0.20587906210425111 0.34500696426556565 -0.069186751593993887 0.27517496502680627 0.13443901700260036 0.089086962117581298 -0.19754820022615735 -0.14029669885651602 0.2357820738547925 0.2647034143616917 0.11228377711010382 -0.00066086246881843309 0.14816917918150985 -0.053646445821275694 0.24772208068305401 0.19651301605902627 -0.028746331239978391 0.34030777869051748 0.20940823355058158 -0.077238879909316382 0.060651249663442569 0.22734778720145618 -0.027744704052982863 0.17740871927790913 0.11311052518523031 -0.28833347679461774 0.22086397545371447 0.1532142055945066 0.20315570267437083 -0.24395914561158988 0.14813866434731052 -0.088421385048614853 -0.12698972212638496 -0.022058807739450407 -0.10943268196691811 0.15379711391720052 0.032596173711942081 0.13391362357744499 0.3084223301171698 0.21238543781913871 0.074113701217313199 -0.21432865210714791 0.043267147607877796 0.27230737411625255 -0.052693334436650884 -0.056995870568788166 -0.0021823669491473248 -0.031256524828515889;-0.17988164602372139 -0.173465703478212 -0.14015907457054866 0.17497374148281836 0.24568856087146151 -0.25226749427950579 0.255533783213796 -0.22026430011982318 -0.052479475110024806 0.045251608215039749 -0.18922990549986968 0.26356254148662889 -0.25046498466311096 -0.18105687610433432 -0.035990636534090015 -0.096920046862620152 -0.16274889387752686 0.15191903448658819 0.28717768373305463 0.25467164934469588 -0.33269101419018954 -0.25450574304180001 -0.28402760503172891 0.23882694617013103 0.08827971500496791 -0.064681511285649002 -0.08535356463998886 -0.070723384617113194 0.071474916186602483 -0.14404095336824066 0.037283235688702412 0.16538609777619762 0.20481505358739455 -0.072320364965408002 0.096191729678349575 0.091296990562695135 0.10088262377781831 0.09233265078482171 0.09123165396509296 -0.037433584067305389 -0.018086730317241249 -0.13184341981560257 -0.27699621911865718 -0.022809820281715174 0.1822384527957466 -0.10400069903689897 -0.28877158444587309 0.14583049249549596 0.0028107872057006253 0.23014110065685967 -0.24726297923441079 -0.30586505228016692 -0.24949456102712886 -0.13617868067074851 -0.11239437304387323 -0.028794959269596933 0.12919976559283575 -0.039712113851918029 -0.068273083851549954 -0.24061674277484155 -0.10132639056929493 -0.2009220142674556 -0.25330196474212846 -0.094489851795815372 0.2533083792111897 -0.074908186699073703 -0.14344774924442347 0.00011123408899548371 -0.13994368792464257 0.061388666712438089 0.12282453198287305 -0.11587780986876761 0.22839823457898892 -0.15927463328561878 -0.19720453322133524 -0.25807757557123762 0.12616016003444289 -0.12226978147095052 0.028724205008096547 0.059392561509322553 0.2147692820886847 0.020840571118782115 -0.13953136996736365 -0.20286424567396905 0.021747088390036126 -0.044286336738999239 -0.024597784146197295;-0.28756900666271423 -0.0084278569425963786 -0.015658077995044178 -0.40845003862848439 0.010648917603341988 0.30103654941704444 -0.36436070570779655 -0.2005211532450808 -0.014360987840993215 0.3646915481423606 -0.10650094251747134 0.20762279907370165 0.32447113324037719 0.15295690841336934 -0.21414839435613733 -0.2530574175609614 -0.17854535128977964 -0.1161146867423694 0.0051328614899215745 0.15015024801653334 -0.17113522499650613 -0.33269209677491907 0.21065851713306025 -0.064027921654451064 -0.053912727845308483 -0.27234761842739275 0.143390946146113 -0.0034970485342365083 -0.094321978054581479 0.053921622807131718 -0.32105697442703113 -0.16178716637501883 -0.39006460207503535 -0.28830825489746731 -0.09388071191376203 -0.36409748009443776 -0.29982020883169769 0.014750140788800497 -0.027137490544503512 -0.23366006400189007 0.014309708831635598 0.1496835921570186 0.16397062892642275 0.27898949929707773 -0.081224064600294174 -0.023604855266035923 -0.29927427090027126 -0.010777388053802845 0.19420842021180082 -0.12587087028569763 0.098210305014137814 -0.10067792278604504 -0.37527759349784878 0.035700202376984347 -0.10964569262229235 0.078816495270656317 -0.095228973147004486 0.01043111876075772 -0.320572669263466 -0.24994831016727004 -0.38304237701725763 -0.29668157141478446 -0.31125524075196526 0.095269294100670615 0.091724493494881737 -0.1426505293342418 -0.08049145372865335 -0.059245680705741488 0.086632111395048589 -0.08790566389081092 -0.052468759472009935 -0.26771330754696709 -0.16547009036330476 0.16032773748010559 0.16003068937403836 0.14729530820997858 0.17463222183558841 -0.03673596425082469 0.082705456910278349 0.17589039089258662 0.02967569086429039 -0.19939417408394225 -0.038855010112107895 -0.16011912590640728 -0.1738080458829821 0.278893328582064 -0.08407268659092644;-0.055455049113819453 -0.0083844386748052543 -0.066530600721837529 -0.051159875314947451 -0.23106473000524061 -0.21328456866264961 0.070980276720767871 -0.0098811251747470269 0.050619452499992938 -0.1086747623551695 0.14968516935509155 0.11167880728782691 -0.056060825109782289 -0.053888937868947329 -0.17106200174918607 -0.1591370400379383 0.2458327240570749 0.1615363201762397 0.41018814440462376 0.16979955668483362 0.077207531101876697 -0.21302280006880667 0.036982432719065303 0.023956973379601988 0.29155601523490787 0.17550554297756893 0.19169188851376526 -0.011398843391264325 0.28655696097593725 0.037887061583192605 0.079719186357969415 0.26542130507846601 0.027463614878306918 0.012764227834621942 0.075943121465571709 0.3529790901025151 0.17145760832374934 0.23538120611768981 0.31930259564907681 -0.20246153618887283 -0.13233820035423191 0.1445945311143399 -0.0018153127881447538 -0.24033242514414671 -0.1081977226013673 0.058511830583547669 -0.12811021919043938 0.0027674685385958974 -0.071357624708744724 0.17580135599431268 0.072372420776365798 0.22236215264870496 -0.017773822351411242 0.32182307279502581 0.17938116850961208 -0.16824253079122783 0.074395184597154468 -0.13650426851541697 0.0068269424913882798 -0.036138920255127951 -0.32397190262854508 -0.082623944546088082 0.017371563831340329 0.10604040592338503 -0.036752433737649998 -0.15813895960833799 -0.17827804213315085 0.2400644956016858 -0.17204034180598882 0.3198805057995403 0.14417240494110256 0.1595139645810458 -0.12868710700773386 0.25441052322447627 0.18255626740346323 0.14277181273611778 0.23398946810886245 0.098740208973510962 -0.14782989906304977 -0.093891286505367863 0.25509353013974084 0.06504745015823013 0.24166007418790164 0.14779068317180027 0.02475153391558391 0.0799565990183808 0.21441667520677521;-0.1697658658864574 -0.21787933781583316 0.11515410226990791 0.16055979954040012 0.10167044855565935 -0.11008542925117257 0.012969128194776636 0.20339409149700383 -0.088536070803160977 0.067670237878315317 -0.056383584655583345 0.12257805836139542 0.12613999599708284 0.081009173133589282 -0.11006681592854275 -0.13451783827737382 0.14382874299640511 -0.20606652872575182 0.050073969616266978 0.13893496368043495 0.13028057150314834 0.19200437266589593 -0.11182352537380143 0.19829970531899971 -0.057764894037740114 0.22953441324775914 -0.042303374974939016 0.20239001336484777 -0.0034929694519895155 0.11594651830010021 0.061190945866448715 0.36469403913301146 -0.14454136519996885 0.16498635394659594 0.024188917100390873 -0.22744853023628026 -0.15325494131192907 0.060306340546111739 -0.079357241780599233 0.24577479915424894 0.020749082904228597 -0.27496824782561924 -0.29684223800640397 0.16001077683139059 -0.14336789801081565 0.20772916935353891 0.10582316023338373 0.1815445208288303 0.28565043553092623 -0.16328761264519714 0.016831585132152171 0.16313875778555514 -0.018697997959689613 0.30392994390034761 0.17342452231468464 0.21508137545979053 0.18306484646000998 0.11115812371089215 -0.011779185088154037 -0.17330030917066164 -0.18108316065088817 0.21554259198251755 -0.11404701406954652 -0.27117780730722235 0.055203192062959344 -0.022518701821190229 0.26501970634278782 0.11004647484260137 0.15575716520950142 0.007000486323780003 0.31415644852675639 -0.13268798953285385 -0.11576250211617348 -0.24693615401735181 0.037783837727662556 0.071195879833451339 0.20826543719310553 0.052848031833967371 0.066250944560715452 0.1628422088740879 -0.18377440927843539 -0.25903137470187532 -0.025802217844732175 0.17389507350595251 -0.15475038100018298 -0.25076233486981542 0.11218073903334574];

% Layer 2
b2 = -0.99646132326189207;
LW2_1 = [-0.064830239894772212 0.11081867037266083 -0.67334205551020876 0.23349948066779358 -0.41452440741472518 0.28550712847298615 -0.59771313525828174 0.26587566151960895 -0.25378088716747527 -0.50381337406917415];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00112397437338429;
y1_step1.xoffset = 5626.5;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
